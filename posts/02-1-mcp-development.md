---
title: "MCP 만들기 - AI 일관성 문제를 직접 해결해보다"
date: "2024-05-25"
category: "methodology"
description: "Claude Projects와 Gemini Gems로도 부족해서, 직접 MCP를 만들어 AI 일관성 문제를 해결하려 했던 과정"
tags: ["ai-first", "mcp", "hi-ai", "claude", "consistency"]
author: "Su Ham"
lang: "ko"
series: "AI 개발 방법론"
seriesOrder: 3
---

# MCP 만들기 - AI 일관성 문제를 직접 해결해보다

Claude Projects와 Gemini Gems에 지침 자료를 등록했더니, 이전보다는 나아졌다.

하지만 여전히 완벽하지 않았다.

문서가 준비되고 개발에 들어가면, 여전히 문제가 생기거나 에러 처리를 못하는 상황이 발생했다.

## 왜 또 일관성이 무너지지?

Projects와 Gems에 이미 다 넣어뒀다:

- 문서 작성법
- 기획 문서
- 개발 코드 컨벤션
- 기술 스택

그런데도 매번 새로운 세션에서 AI는 조금씩 다르게 행동했다.

같은 질문에 다른 답변을 하거나, 같은 요청에 다른 코드를 만들어냈다.

### 진짜 문제: 컨텍스트를 활용하는 방식이 달랐다

AI는 지침 자료를 읽긴 하는데, 어떤 부분을 중요하게 볼지는 매번 달랐다.

어떤 세션에서는 기술 스택에 집중했다. 어떤 세션에서는 코드 컨벤션에 집중했다. 어떤 세션에서는 기획 문서의 핵심 기능만 봤다.

## 그래서 MCP를 만들기로 했다

"AI가 일관되게 행동하려면, 내가 원하는 방식으로 정보를 제공해야 하는 거 아닐까?"

MCP (Model Context Protocol)는 AI가 외부 도구나 데이터에 접근할 수 있게 해주는 프로토콜이다.

이걸 활용해서, AI가 폴링고 개발할 때 필요한 정보를 정확하게 제공하는 도구를 만들고 싶었다.

### hi-ai 프로젝트 시작

https://github.com/su-record/hi-ai

목표: AI 개발 시 일관성을 유지하기 위한 MCP 도구 만들기

처음엔 간단하게 시작했다:

1. 기획 문서 읽어오기
2. 엔티티 정보 제공하기
3. API 명세 가져오기
4. 코드 컨벤션 체크하기

## MCP를 만들면서 배운 것들

### 1. AI에게 정보를 주는 방식이 중요하다

처음엔 그냥 문서 전체를 던져줬다.

하지만 AI는 필요한 부분만 빠르게 찾을 수 있어야 했다.

키워드 기반 검색을 추가했다. AI가 "결제 기능"을 물어보면, 결제 관련 엔티티, API, 비즈니스 로직만 딱 제공한다.

### 2. 메모리 관리가 핵심이더라

AI는 이전 대화를 기억하지만, 컨텍스트 윈도우 한계가 있다.

hi-ai에 인텔리전트 메모리 관리 기능을 넣었다:

- 자주 사용되는 정보는 우선순위 높게
- 한번 제공한 정보는 다시 제공하지 않고
- 세션이 바뀌어도 이전 작업 이력 추적

### 3. 의도를 파악하는 게 중요했다

AI가 질문할 때, 진짜 필요한 게 뭔지 파악해야 했다.

"엔티티 보여줘"라고 하면:
- 전체 엔티티 목록?
- 특정 엔티티의 상세 정보?
- 엔티티 간 관계도?

의도 인식(Intent Recognition) 기능을 추가했다. 한국어, 영어 모두 지원하게 만들었다.

### 4. 코드 분석도 필요했다

문서만으로는 부족했다. 실제 코드와 문서가 일치하는지 확인이 필요했다.

시맨틱 코드 분석 기능을 넣었다:
- 코드 품질 체크
- 컨벤션 준수 여부
- 문서와 코드 일치성 검증

## 34개의 전문화된 도구

결국 hi-ai는 34개의 도구를 가진 MCP가 됐다:

- 프로젝트 컨텍스트 관리
- 문서 검색 및 제공
- 엔티티/API 정보 제공
- 코드 분석 및 검증
- 메모리 관리
- 의도 인식

평균 응답 시간은 100ms 이하로 만들었다. AI가 기다리지 않게.

## 결과는 어땠을까?

솔직히 말하면, 완벽한 해결책은 아니었다.

hi-ai를 사용하니:

### 좋아진 점

- 문서 찾는 시간이 확실히 줄었다
- 같은 정보를 반복해서 제공할 필요가 없었다
- 코드 컨벤션 체크가 자동화됐다

### 여전히 남은 문제

- AI가 여전히 요구하지 않은 내용을 추가했다
- 일관성 문제가 완전히 해결되지는 않았다
- DB 스키마와 모델이 여전히 일치하지 않을 때가 있었다

## 깨달음: 도구만으로는 부족하다

MCP를 만들면서 깨달았다.

> **AI 일관성 문제는 도구만으로 해결되는 게 아니다.**

AI에게 정보를 주는 방식도 중요하지만, AI에게 작업을 시키는 방식이 더 중요했다.

- 어떤 순서로 문서를 읽게 할 것인가?
- 어떤 우선순위로 작업하게 할 것인가?
- 어떻게 검증하고 교차 확인하게 할 것인가?

이 문제는 MCP로 해결할 수 없었다.

방법론이 필요했다.

## 포기하려던 순간

이때가 정말 앱 만드는 걸 포기하려던 때였다.

문서도 만들었다. Projects와 Gems도 활용했다. MCP까지 만들었다.

여전히 일관성 문제는 해결되지 않았다.

DB 스키마와 모델이 일관성을 갖지 못하니까, 수정하고 또 수정하는데 돈만 들었다.

내가 FastAPI, 백엔드 개발, Flutter를 알았다면 어떻게든 해봤을 텐데, 그럴 수 없었다.

### 그래도 계속했다

내 질문하는 능력, 요구사항 전달하는 능력이 문제라고 생각했다.

AI와 대화를 통해 더 나은 방법을 찾아보기로 했다.

지금까지의 실패를 AI에게 설명했다.

그리고 함께 새로운 방법을 찾기 시작했다.

## hi-ai의 현재

지금도 hi-ai는 개발 중이다. 폴링고를 만들면서 계속 개선하고 있다.

MCP 자체는 완벽한 해결책이 아니었지만, AI와 협업하는 방법을 고민하게 만들었다.

그 고민이 결국 새로운 방법론을 찾게 해줬다.
