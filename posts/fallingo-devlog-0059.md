---
title: "fallingo 개발일지 - 3d14943..3a90f86 (10개 커밋)"
date: "2026-01-30"
category: "dev-log"
description: "Azure Container Jobs 전환 및 모바일 카메라 성능 최적화"
tags: ["fallingo", "개발일지", "Azure", "Flutter", "FastAPI", "DevOps"]
author: "Su"
lang: "ko"
---

안녕하세요, Fallingo 프로젝트를 개발하는 Su입니다. 👋
1978년생 개발자의 개발 분투기, 이번 주 개발일지를 공유합니다.

이번 기간은 단 이틀(1월 29일 ~ 30일)이었지만, 인프라의 핵심 축 하나를 통째로 들어내는 대규모 리팩토링과 모바일 앱의 가장 중요한 기능인 카메라 프레임 분석 최적화 작업을 병행했습니다. 인프라 변경 때문에 예상치 못한 삽질이 많았습니다 😂.

**작업 기간**: 2026-01-29 ~ 2026-01-30 (총 10개 커밋)

---

## 📝 이번 기간 작업 내용

이번 주 작업은 크게 백엔드 인프라의 '스케줄링' 영역과 모바일 앱의 '성능/UX' 영역으로 나뉩니다.

### 1. 인프라 및 백엔드 스케줄러 전환 (5개 커밋) ⚙️

가장 많은 시간과 정신력을 소모했던 작업입니다. 그동안 백엔드(FastAPI) 내에서 주기적인 데이터 정합성 검사나 캐시 업데이트를 위해 Python 기반의 `APScheduler`를 사용했었습니다. 하지만 컨테이너 환경에서 안정적인 운영과 관리의 복잡성을 줄이기 위해 클라우드 네이티브 방식으로 전환하는 큰 결단을 내렸습니다.

| Type | Commit Message 요약 | 내용 및 배움 |
| :--- | :--- | :--- |
| **Refactor/Feat** | APScheduler 완전 제거 → Azure Container Apps Jobs 전환 | 파이썬 앱 내부 스케줄러를 완전히 걷어내고, Azure Container Apps의 Jobs 기능을 사용하여 Cron 작업을 분리했습니다. |
| **Fix** | AsyncIOExecutor 적용 수정 | (전환 전) APScheduler 사용 시 `async` 작업을 실제로 실행시키기 위한 Executor 설정을 바로잡았습니다. (이후 완전히 제거됨) |
| **Fix/Revert** | 배포 환경 수정 (Docker 관련) | 스케줄러 전환 및 배포 설정 변경 과정에서, Oryx 빌더와의 호환성 문제가 생겨 Dockerfile 명시적 지정 및 `alembic.ini` 포함 등을 수정/복원했습니다. |

**결론**: 스케줄링 기능을 클라우드 서비스로 이관함으로써, FastAPI 컨테이너는 오직 API 응답에만 집중할 수 있게 되었습니다. 이는 안정성 및 확장성 측면에서 큰 이득입니다.

### 2. 모바일 앱 성능 및 UX 최적화 (5개 커밋) 📱

Fallingo의 핵심은 실시간 음식 감지입니다. 카메라와 위치 기반 서비스를 동시에 처리하는 과정에서 발생하는 성능 이슈와 UX 플로우의 병목을 해결하는 데 집중했습니다.

| Type | Commit Message 요약 | 내용 및 배움 |
| :--- | :--- | :--- |
| **Feat/Refactor** | 카메라 프레임 메모리 최적화 및 적응형 분석 간격 구현 | 연속적인 카메라 프레임 처리 시 발생하는 메모리 사용량을 줄이고, 기기 성능 및 부하에 따라 분석 간격을 동적으로 조절하는 로직을 추가했습니다. (배터리 효율 및 발열 개선 기대) |
| **Refactor** | 스플래시 플로우 개선 (위치/FCM 비블로킹) | 앱 기동 시 위치 권한 확인, FCM 토큰 수집, 지오펜싱 설정 등을 병렬(비블로킹) 처리하여 스플래시 화면 대기 시간을 단축했습니다. |
| **Fix** | 카메라 실시간 음식 감지 셔터음 제거 | 사용자 경험을 저해하는 불필요한 셔터음(혹은 유사 알림음)을 제거하여 부드러운 감지 경험을 제공했습니다. |
| **Fix** | iOS Deployment Target 통일 | iOS 최소 배포 타겟을 13.0에서 15.0으로 통일하여 최신 프레임워크와 기능(특히 AI/ML 관련)을 안정적으로 사용할 수 있는 기반을 마련했습니다. |

**결론**: Fallingo 앱의 '속도'와 '경험'을 결정하는 가장 중요한 초기 진입 및 핵심 감지 루틴을 다듬었습니다.

---

## 💡 작업 하이라이트: Cloud Native로의 대담한 전환

### 1. APScheduler를 버리고 Azure Jobs를 택한 이유

개발 초기에는 백엔드 컨테이너 내에서 `APScheduler`를 사용하는 것이 가장 간단한 방법이었습니다. 하지만 AsyncIO 환경(FastAPI)에서 스케줄러를 안정적으로 운영하는 것은 생각보다 까다로웠습니다. 초기에는 `AsyncIOExecutor` 설정으로 겨우 문제를 해결했지만 (위의 fix 커밋 참고), 컨테이너가 스케일 아웃될 때마다 Cron 작업이 중복 실행되는 이슈를 막기 위한 추가적인 락(Lock) 관리가 필요했습니다.

클라우드 환경에서 개발하는 만큼, PaaS의 기능을 최대한 활용하는 것이 장기적으로 개발 및 운영 비용을 줄이는 길이라고 판단했습니다.

| 구분 | APScheduler (In-Container) | Azure Container Apps Jobs (Cloud Native) |
| :--- | :--- | :--- |
| **복잡성** | Lock 관리, Executor 설정, 로그 분리 필요 | 간단한 YAML 정의, FastAPI 컨테이너와 분리 |
| **비용 효율** | 24/7 컨테이너 리소스 소모 | 필요할 때만 실행(Consumption) |
| **신뢰성** | 컨테이너 오류 시 스케줄 실패 가능성 | Azure 서비스 보장 |

APScheduler를 완전히 제거하고 Jobs 컨테이너를 별도로 구성하는 것은 큰 결정이었지만, 덕분에 FastAPI 코드가 더욱 순수해지고 인프라 구조가 명확해졌습니다.

### 2. 메모리 최적화와 UX 개선의 중요성

Fallingo는 카메라를 이용한 AI 분석을 지속적으로 수행해야 합니다. 이는 모바일 기기 배터리와 메모리에 큰 부담을 줍니다.

이번에 적용한 **카메라 프레임 메모리 최적화 및 적응형 분석 간격** 로직은 다음과 같은 목표를 가집니다.

1.  **메모리 절약:** 분석이 끝난 프레임 데이터를 즉시 해제하여 메모리 힙 오버플로우를 방지했습니다.
2.  **적응형 분석:** 기기의 CPU 사용률을 모니터링하여, 부하가 높을 때는 프레임 분석 간격(예: 0.1초 → 0.5초)을 자동으로 늘려 성능 하락과 발열을 막았습니다.

이와 함께 스플래시 화면에서 발생하던 동기적(Blocking) 초기화 작업을 모두 비동기(Non-Blocking)로 전환하여, 사용자가 앱을 여는 순간부터 쾌적함을 느낄 수 있도록 UX를 개선했습니다.

---

## 📊 개발 현황

저는 현재 Google for Startups Cloud Program의 크레딧 지원 ($2,000)을 적극적으로 활용하며 백엔드 인프라 안정화에 총력을 기울이고 있습니다. Azure Container Apps Jobs로의 전환도 이 프로그램 덕분에 더욱 과감하게 시도할 수 있었습니다.

| 영역 | 진행도 | 비고 |
| :--- | :--- | :--- |
| 백엔드 (FastAPI, PostgreSQL) | 90% | 핵심 기능 구현 완료, 인프라 안정화 작업 진행 중 |
| 모바일 (Flutter) | 85% | 주요 AI 감지 및 CRUD 흐름 완성, UX/성능 최적화 반복 |
| 인프라 (Azure) | 80% | DB, API, 스케줄러 환경 구축 완료. 모니터링 및 로깅 시스템 완성 필요 |

베타 런칭(2025년 12월)까지 아직 시간이 넉넉하여, 현재는 사용자 경험을 극대화하기 위한 작은 버그와 성능 병목을 잡는 데 집중하고 있습니다. 특히 비전공자 출신으로 백엔드 인프라를 다루는 것이 새로운 도전이지만, 매일매일 새로운 것을 배우고 있습니다.

다음 개발일지에서는 인프라 모니터링 설정이나 Flutter 앱 내 상태 관리 패턴에 대해 더 자세히 공유할 수 있기를 기대합니다.

감사합니다! 🙏